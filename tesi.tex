% draft 3rd year diploma thesis, by Nick Manini, 2013/03/22
\documentclass[a4paper,12pt]{article}
\usepackage[english]{babel} % or other languages, e.g:
%\usepackage[italian]{babel} % needs debian package texlive-lang-italian
%\usepackage[latin1]{inputenc} % use to reproduce accented characters correctly
\usepackage{hyperref}
\usepackage{graphicx}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{physics}
\usepackage[width=125mm]{caption}

\usepackage[document]{ragged2e}

% Dimensione della pagina
\setlength{\oddsidemargin}{.3in}  % Distance from the left edge -1 inch 
\setlength{\textwidth}{145mm}     % Normal width of the text
\setlength{\topmargin}{.25in}     % Distance from top to PAGE'S HEAD -1 inch
\setlength{\textheight}{225mm}    % Height of the body of page
\setlength{\headheight}{0mm}      % Height of a box containing the head
\setlength{\parskip}{0.5mm}         % Extra vertical space before a paragraph
\setlength{\parindent}{9mm}       % Width of the indentation 
\linespread{1.12}                 % Line spacing        
\renewcommand{\floatpagefraction}{.9}

\usepackage{xcolor}
\newcommand\mynotes[1]{\begin{flushright}\textcolor{red}{TODO: #1}\end{flushright}}
\newcommand{\jsqrt}[2]{\bqty{ #1 #1 | #2 #2 }}
\newcommand{\ksqrt}[2]{\bqty{ #1 #2 | #2 #1 }}

\begin{document}

\title{\bf \Huge Titolazzo della tesi, if seems long\\go to newline }


\author{Giorgio Ruffa\\
Dipartimento di Fisica, Universit\`a degli Studi di Milano,\\
Via Celoria 16, 20133 Milano, Italia
}
\date{April 22, 2016} % the exact date of graduation, when available


\include {frontespizio} % eccezionalmente qui include il frontespizio
% in general avoid \include altoghether, it is looking for trouble !!

\newpage\qquad
\newpage

\maketitle

%---------------------------------------------------------
\begin{abstract}

A long time ago in a galaxy far, far away...

\vskip0.75cm
\hskip5cm
\parbox[t]{7cm}
{
Advisor: {\it Prof. Dario Tamascelli}\\
Co-Advisor: {\it Prof. Michele Ceotto}
}
\end{abstract}
%--------------------------------------------------------

\newpage
\tableofcontents
\newpage

%----------------------------------------------------------------------------
\section{Quantum Espresso}
%----------------------------------------------------------------------------

Quantum ESPRESSO is an integrated suite of Open-Source computer codes for electronic-structure calculations and materials modeling at the nanoscale.
It is based on density-functional theory, plane waves, and pseudopotentials.

\mynotes{Scritto per girare su un gazilione di architetture}

\section{Theoretical Introduction}\label{model:sec}
\mynotes{metti citazione da manuale giocoleria su divisione del problema in piccole parti risolvibili}

This section will cover the basic theory upon which Quantum ESPRESSO is based.

By starting with a very general approach we can say that the Hamiltonian associated to a system of atoms with $N_N$ nuclei and $N_e$ electrons can be written as:


\begin{equation}\label{eq:theHamiltonianLong}
\hat{H}_{tot} = \hat{T}_{N} + \hat{T}_{e} + \hat{V}_{Ne} + \hat{V}_{NN} + \hat{V}_{ee}
\end{equation}

Where:

\begin{equation}
\hat{T}_{N} = \frac{\hbar}{2} \sum_{\alpha}^{N_N} \frac{\nabla_{\alpha}^2}{M_{\alpha}}
\end{equation}
Is the kinetic energy of the nuclei

\begin{equation}
\hat{T}_{e} = \frac{\hbar}{2m_{e}} \sum_{i}^{N_e} \nabla_{i}^2
\end{equation}
Is the kinetic energy of the electrons

\begin{equation}
\hat{V}_{Ne} = -\frac{e^2}{4\pi\epsilon_{0}} \sum_{i}^{N_e}\sum_{\alpha}^{N_N} \frac{Z_{\alpha}}{\mid R_{\alpha} - r_{i} \mid }
\end{equation}
is the electron-ion attraction potential energy

\begin{equation}
\hat{V}_{NN} = \frac{e^2}{4\pi\epsilon_{0}} \frac{1}{2} \sum_{\alpha \neq \beta}^{N_N} \frac{Z_{\alpha} Z_{\beta}}{\mid R_{\alpha} - R_{\beta} \mid }
\end{equation}
is the nucleus-nucleus repulsion potential energy

\begin{equation}
\hat{V}_{ee} = \frac{e^2}{4\pi\epsilon_{0}} \frac{1}{2} \sum_{i \neq j}^{N_e} \frac{1}{\mid r_{i} - r_{j} \mid }
\end{equation}
is the electron-electron repulsion potential energy

A state function $\ket{\psi}$ describing all the particles involved in the system will evolve following the Schrodinger equation.
\begin{equation}\label{eq:eq_sch}
	i\hbar\dv{t}\ket{\psi(t)} = \hat{H}_{tot}\ket{\psi(t)}
\end{equation}

If not explicitly specified, from now on we will use atomic units \cite[p.42]{Attila} to express any equation.
We shall rewrite equation \eqref{eq:theHamiltonianLong} in a much more elegant form:


\begin{equation}\label{eq:theHamiltonian}
\boxed{
	\hat{H}_{tot}   = - \sum_{\alpha}^{N_N} \frac{\nabla^2_{\alpha}}{2M_{\alpha}}
					+ \frac{1}{2}\sum_{\alpha \neq \beta}^{N_N} \frac{Z_{\alpha} Z_{\beta}} {R_{\alpha \beta}}
					- \sum_{i}^{N_e} \frac{\nabla_{i}^2}{2}
					- \sum_{i}^{N_e} \sum_{\alpha}^{N_N} \frac{ Z_{\alpha} }{r_{i \alpha}}				
					+ \frac{1}{2} \sum_{i \neq j}^{N_e} \frac{1}{r_{ij}}
}
\end{equation}
With:
\begin{align*}
	r_{ij} & = \mid r_{i} - r_{j} \mid 
\\
	r_{i \alpha} & = \mid r_{i} - R_{\alpha} \mid 
\\
	R_{\alpha \beta} & = \mid R_{\alpha} - R_{\beta} \mid 
\end{align*}

Although the universality of this equation\footnote{It must be noted that we are neglecting any relativistic effect.}, we know very well that even a simple molecule like $H_2^{+}$ has no analytical solution.

Thus, even from a computational standpoint, a set of approximations must be performed.


\subsection{The Bohr-Oppenheimer Approximation}

The Bohr-Oppenheimer approximation takes note of the great difference in masses of electrons and nuclei.
Nuclear mass is much higher than electron mass, so we expect electrons to have much higher velocities than	 nuclei. 

It's now reasonable to separate the motion of the system in two distinct movements: the \textit{``slow"} movement of the nuclei, and the \textit{``fast"} movement of the electrons.

We can say that from the point of view of electrons, the nuclei appear to be fixed. 
From a physical standpoint the electrons are moving in the static field produced by the nuclei while still interacting within each others \cite[p.241]{Atkins97}.


Using this approximation the kinetic energy of the nuclei $\hat{T}_{NN}$ can be neglected and the repulsion between the nuclei $\hat{V}_{NN}$, can be considered to be constant.

We will consider now the electronic Hamiltonian $H_{elec}$ :
\begin{equation}
	\hat{H}_{e} = \hat{T}_{e} + \hat{V}_{Ne} + \hat{V}_{ee}
\end{equation}

Rewriting $\hat{H}_{e}$  using atomic units:
\begin{equation}\label{eq:H_elec}
	\hat{H}_{e} = 	- \sum_{i}^{N_{e}} \frac{1}{2} \nabla_{i}^2  
					- \sum_{i}^{N_{e}} \sum_{\alpha}^{N_{N}} \frac{Z_{\alpha}}{r_{i\alpha}}  
					+ \frac{1}{2} \sum_{i \neq j}^{N_{e}} \frac{1}{r_{ij}}
\end{equation}

The associate Schroedinger equation is,
\begin{equation}
	\hat{H}_{e} \ket{\Phi_{e}} = \epsilon_{e} \ket{\Phi_{e}}
\end{equation}

With solution
\begin{equation}
	\ket{\Phi_{e}} = \ket{\Phi_{e}( \{r_{i}\};\{R_{\alpha}\} )}
\end{equation}

Where the dependency from the electronic coordinates $\{r_i\}$ is explicit, but the dependency from nuclear coordinates $\{R_{\alpha}\}$ is parametrical.
This implies that also the electronic energy depends parametrically on $\{R_{\alpha}\}$

\begin{equation}
	\epsilon_{e} = \epsilon_{e}(\{R_{\alpha}\})
\end{equation}

To obtain the total energy (with fixed nuclei) we have to add the constant ion-ion Coulomb potential energy

\begin{equation}\label{eq:totEn1}
	\epsilon_{tot} = \epsilon_{e} + \frac{1}{2} \sum_{\alpha \neq \beta}^{N_N} \frac{Z_{\alpha} Z_{\beta} }{R_{\alpha \beta}}
\end{equation}

Equation from \eqref{eq:H_elec} to \eqref{eq:totEn1} constitutes the so called \textit{``Electronic Problem"} \cite[p.44]{Attila}.

Once solved one could then apply the same principle to the nuclear problem.
Since the electrons moves much faster then the nuclei, it is reasonable to approximate \eqref{eq:theHamiltonian} by replacing electronic coordinates by their average value, averaged over $\Phi_{e}$.
The nuclear Hamiltonian will be :
\begin{equation}
	H_{N} = - \sum_{\alpha}^{N_{\alpha}} \frac{1}{2M_{\alpha}} \nabla_{\alpha}^2 + \epsilon_{tot}(\{ R_{\alpha}\})
\end{equation}

We can see that $\epsilon_{tot}(\{ R_{\alpha}\})$ is a potential energy surface for nuclear motion.

Thus the nuclei in the Born-Oppenheimer move on a potential energy surface obtained by solving the electronic problem.

The nuclear Schrodinger equation  
\begin{equation}
	\hat{H}_{N} \ket{\Phi_{N}} = \epsilon \ket{\Phi_{N} }
\end{equation}

with solution 

\begin{equation}
	\ket{\Phi_{N}}=\ket{\Phi_{N}(\{R_{\alpha}\})}
\end{equation}

will describe vibration, rotation, and translation of the molecule.

The complete approximate solution to \eqref{eq:theHamiltonian} will be  \cite[p.43-45]{Attila}

\begin{equation}
	\ket{ \Phi(\{r_i\};\{R_{\alpha}\}) } 	= \ket{ \Phi_{e}(\{r_i\};\{R_{\alpha}\})} 
											~ \ket{ \Phi_{N}(\{R_{\alpha}\})}
\end{equation}

Since \textit{``electronic problem"} is of much more interest in this work, from now on we will drop the suffix ``$e$" for the Hamiltonian $H_{e}$.

\subsection{The Hartree Product}
\subsubsection{Spin-Orbit}
We introduce two spin functions  $\alpha(\omega), \beta(\omega)$, corresponding respectively to spin up and spin down.
The only conditions we impose is that these two functions are orthonormal and a complete set of auto-functions for the spin operator $\hat{S}_z$ .

\begin{align*}
	\bra{\alpha}\ket{\alpha} = \bra{\beta}\ket{\beta} = 1 \\
	\bra{\alpha}\ket{\beta} = \bra{\beta}\ket{\alpha} = 0
\end{align*}

An electron is described by three spacial coordinates $\mathbf{r}$ and one spin coordinate $\omega$.
\begin{equation}
	\mathbf{x} = \{\mathbf{r},\omega\}
\end{equation}

We define $\psi_i(\mathbf{r})$ a spacial orbital as a function of the position vector $\mathbf{r}$ describing the spacial distribution of an electron, so that $\mid\psi_i(\mathbf{r})\mid^2 {dr}^3$ is the probability of finding the electron in a small volume ${dr}^3$ centered at position $\mathbf{r}$.

Given a set of spatial orbitals we will assume them to be orthonormal, thus if the set is complete we can express any spatial state function as a linear combination of spatial orbitals.

In general, for the set to be complete, one should consider it as infinite. As you can imagine, in practice, an infinite orbitals' set is not available and we will consider only a finite set composed of $K$ such orbitals. The finite set will only cover a certain region of the complete space, but we will consider the results to be ``exact" within the subspace generated by the finite set of spatial orbitals.

The combination of a spatial orbital and a spin function is called a spin orbital and completely describes the electron. 
\begin{equation}
	\chi_{i}(\mathbf{x}) = \psi_i(\mathbf{r}) \alpha(\omega)
\end{equation}


For a set of K spatial orbital will have a corresponding set of $2K$ spin orbitals, each pair sharing the same spatial orbital but with different spin function:

\begin{equation}
	\chi_{2i} = \psi_i(\mathbf{r}) \alpha(\omega)
\end{equation}
\begin{equation}
	\chi_{2i-1} = \psi_i(\mathbf{r}) \beta(\omega)
\end{equation}

Being the spatial orbital and spin orbitals orthonormal, so are the spin orbitals.

\subsubsection{Separating the problem}

It is evident that the term $V_{ee}$ in \eqref{eq:H_elec} is the more complicated to handle in order to find an exact solution to the electronic problem.
To simplify the system we start by neglecting $V_{ee}$, considering the electrons as non interacting.
The Hamiltonian \eqref{eq:H_elec} can be rewritten in the following form:
\begin{align}
	\hat{H} & = \sum_{i}^{N_{e}} \hat{h}_{i} \label{eq:HartreeHamiltonian} 
	\\
	\hat{h}_{i} & = \frac{1}{2} \nabla_{i}^2 - \sum_{\alpha}^{N_{N}} \frac{Z_{\alpha}}{r_{i\alpha}}  \label{eq:singleElHam}
\end{align}


In this form $\hat{H}$ is composed by a sum of $N_e$ independent single electron Hamiltonians of the form \eqref{eq:singleEl}.

Each operator $\hat{h}_i$ will have his spin orbital eigenfunction with eigenvalue given by
\begin{equation}
	\hat{h}_{i} \ket{\chi_{i}(\mathbf{x}_i) } = \epsilon_{i} \ket{\chi_{i}(\mathbf{x}_i) }
\end{equation}

Since \eqref{eq:HartreeHamiltonian} is a sum of independent Hamiltonians his eigenfunctions will be the tensor product of $\hat{h}_i$ eigenfunctions
\begin{align}\label{eq:HartreeProduct}
	\ket{\Psi^{HP}(\mathbf{x}_{1},...,\mathbf{x}_{N_e})} = & \ket{\chi_1(\mathbf{x}_{1})} \otimes \cdots  \otimes \ket{\chi_N(\mathbf{x}_{N})} \\
	:= & \ket{ \chi_{1}(\mathbf{x}_{1}) \cdots \chi_{N}(\mathbf{x}_{N}) }
\end{align}
with eigenvalue
\begin{equation}
	\hat{H}\ket{\Psi^{HP}} = E\ket{\Psi^{HP}}
\end{equation}
\begin{equation}
	E = \epsilon_i + \epsilon_j + ... + \epsilon_k
\end{equation}

It must be noted that in equation \eqref{eq:HartreeProduct} there is no correlation between the index of the spin-orbital $\chi_{i}$ to the index of the electron's coordinates $\mathbf{x}_i$. It is absolutely and completely reasonable to have the $j$-th electron in the $i$-th spin-orbital e.g : $\chi_{j}(\mathbf{x}_{i})$.
One should also consider that the number of spin-orbitals that describes our system can be (and often is) greater than the total number of electrons. The use of the same index is, by any means, an excess of notation.


Equation \eqref{eq:HartreeProduct} is called an \textit{Hartree Product} and has the following straightforward property: 
\begin{equation}\label{eq:uncorrelated}
	\mid\Psi^{HP}(\mathbf{x}_1,\cdots,\mathbf{x}_{N_e}) \mid^2 dx_1^3 \cdots dx_{N_e}^3 = \mid\chi_i(\mathbf{x}_1)\mid^2 dx_1^3 \cdots \mid \chi_k(\mathbf{x}_{N_e})\mid^2 dx_{N_e}^2
\end{equation}

Meaning that the probability of finding simultaneously (with an unique measure) each electron in a fixed position (within a small volume) is equal to the uncorrelated probability of finding electron 1 in position $x_1$ times the probability of electron 2 in position $x_2$ and so on (by independent measurements).
For this reason $\Psi^{HP}$ is called an uncorrelated or electron-independent wave function. 
Namely, the position of one electron has no effect on the position of the others. 

This is, of course, a strong assumption but we will see how the Hartree-Foch method will correct the approximation.



\subsubsection{Identical Particles and Slater Determinant}

$\Psi^{HP}$ is the simplest representation of a multi-electron state function, but it does not respect the invariance by exchange of identical particles.
Since elementary particles like electrons are identical or indistinguishable, the probability distribution associated to the state function describing the entire system should remain the same if the coordinates of two or more particles are exchanged.

\begin{equation}
	\mid \Psi(\mathbf{x}_1,\dots,\mathbf{x}_i,\dots,\mathbf{x}_j,\dots,\mathbf{x}_{N_e}) \mid^2 = \mid \Psi(\mathbf{x}_1,\dots,\mathbf{x}_j,\dots,\mathbf{x}_i,\dots,\mathbf{x}_{N_e}) \mid^2
\end{equation}

This implies one of the following conditions:
\begin{align}
	\Psi(\mathbf{x}_1,\dots,\mathbf{x}_i,\dots,\mathbf{x}_j,\dots,\mathbf{x}_{N_e}) = 
		+\Psi(\mathbf{x}_1,\dots,\mathbf{x}_j,\dots,\mathbf{x}_i,\dots,\mathbf{x}_{N_e})\\
	\Psi(\mathbf{x}_1,\dots,\mathbf{x}_i,\dots,\mathbf{x}_j,\dots,\mathbf{x}_{N_e}) = 
		-\Psi(\mathbf{x}_1,\dots,\mathbf{x}_j,\dots,\mathbf{x}_i,\dots,\mathbf{x}_{N_e}) 
\end{align}

Namely that the state function is respectively symmetric or antisymmetric.
Particles with integer spin, like protons, are called bosons and are always represented by symmetric wave functions.
Particles with half integer spin, like electrons, are called fermions and are always represented by antisymmetric wave functions.

We can immediately verify that even the simplest Hartree product composed by only two spin orbit does not respect the antisymmetry principle.

\begin{equation*}
	\ket{\Psi^{HP}(\mathbf{x}_1,\mathbf{x}_2)} = \ket{\chi_1(\mathbf{x}_1)} \ket{\chi_2(\mathbf{x}_2)} \neq \ket{\chi_1(\mathbf{x}_2)} \ket{\chi_2(\mathbf{x}_1)}
\end{equation*}

The easiest way to make $\Psi^{HP}$ antisymmetric is to introduce what is called an \textit{exchange term}.

\begin{equation}\label{eq:slater2}
	\ket{\Psi(\mathbf{x}_1,\mathbf{x}_2)} = \frac{1}{\sqrt{2}} (\ket{\chi_1(\mathbf{x}_1)} \ket{ \chi_2(\mathbf{x}_2)} - \ket{\chi_1(\mathbf{x}_2)} \ket{\chi_2(\mathbf{x}_1)} )
\end{equation}

We can rewrite \eqref{eq:slater2} as the determinant of the matrix :
\begin{equation}
\ket{\Psi(\mathbf{x}_1,\mathbf{x}_2)} = \frac{1}{\sqrt{2}}
\begin{vmatrix}
\chi_1(\mathbf{x}_1) & \chi_2(\mathbf{x}_1) \\
\chi_1(\mathbf{x}_2) & \chi_2(\mathbf{x}_2) 
\end{vmatrix}
\end{equation}

The generalization to $N_e$ electrons held to:

\begin{equation}\label{eq:SlaterDet}
\ket{\Psi(\mathbf{x}_1, \mathbf{x}_2, \ldots, \mathbf{x}_N)} =
\frac{1}{\sqrt{N!}}
\left|
	\begin{matrix} 
   		\chi_1(\mathbf{x}_1) & \chi_2(\mathbf{x}_1) & \cdots & \chi_N(\mathbf{x}_1) \\
        \chi_1(\mathbf{x}_2) & \chi_2(\mathbf{x}_2) & \cdots & \chi_N(\mathbf{x}_2) \\
		\vdots & \vdots & \ddots & \vdots \\
        \chi_1(\mathbf{x}_N) & \chi_2(\mathbf{x}_N) & \cdots & \chi_N(\mathbf{x}_N)
    \end{matrix} 
	\right|\equiv \left| 
	\begin{matrix}
		   \chi _1 & \chi _2 & \cdots  & \chi _N  \\
	\end{matrix}
   \right|,
\end{equation}

Equation \eqref{eq:SlaterDet} is called the \textit{Slater Determinant} and is the simplest asymmetrical representation of a multi-electron state function.

Using a more formal approach outlined in \cite[p.357-362]{Sakurai} we can express the exchange of two coordinates in \eqref{eq:HartreeProduct} as the action of the transposition operator $\hat{P}_{ij}$ 
\begin{align} \label{eq:transpositionOp}
	\begin{split}
		\hat{P_{ij}} & \ket{\chi_1(\mathbf{x}_1)   \cdots  \chi_i(\mathbf{x}_i)  \cdots  \chi_j(\mathbf{x}_j)  \cdots   \chi_N(\mathbf{x}_N)} =   \\ 
		& \ket{\chi_1(\mathbf{x}_1)   \cdots  \chi_j(\mathbf{x}_i)  \cdots  \chi_i(\mathbf{x}_j) \cdots  \chi_N(\mathbf{x}_N)} 
	\end{split}
\end{align}
\begin{equation*}
	\hat{P}_{ij} = \hat{P}_{ji} ~;~
	\hat{P}_{ij}^2 = \mathbf{1}
\end{equation*}

Note that in equation \eqref{eq:transpositionOp} we maintained the position of the electron index and switched the spin-orbital index. In this way it is possible to rewrite \eqref{eq:transpositionOp} in a more compact way :
\begin{equation}
	\hat{P_{ij}}  \ket{\chi_1  \cdots  \chi_j  \cdots  \chi_i  \cdots   \chi_N} =  
		 \ket{\chi_1   \cdots  \chi_j  \cdots  \chi_i \cdots  \chi_N} 
\end{equation}
The sequential position of the spin-orbitals indicates coincides with the index of the electron represented \cite{Sakurai}.


For the ket state to be antisymmetric it must be an eigenfunction of $\hat{P}_{ij}$ with eigenvalue $-1$.
\begin{align*}
	\hat{P_{ij}} & \ket{\chi_1(\mathbf{x}_1)   \cdots  \chi_i(\mathbf{x}_i)  \cdots  \chi_i(\mathbf{x}_j)  \cdots   \chi_N(\mathbf{x}_N)} =  \\
	-1 & \ket{\chi_1(\mathbf{x}_1)   \cdots  \chi_i(\mathbf{x}_i)  \cdots  \chi_i(\mathbf{x}_j) \cdots  \chi_N(\mathbf{x}_N)} 
\end{align*}

It can be shown that an arbitrary permutation of N objects can be written as a product of transpositions and that the number of transposition in this decomposition is of fixed parity. That is, either a permutation is always decomposed in an even number of transpositions (the permutation is called even and has the parity $+1$), or a permutation is always decomposed in an odd number of transpositions and then it is an odd permutation with parity  $ - 1$.

Denoting the parity of the arbitrary permutation as $\sigma_P$ it follows that antisymmetric function must respect the following condition :
\begin{align*}
	\hat{P} & \ket{\chi_1(\mathbf{x}_1)   \cdots  \chi_i(\mathbf{x}_i)  \cdots  \chi_i(\mathbf{x}_j)  \cdots   \chi_N(\mathbf{x}_N)} = \\
	(-1)^{\sigma_P}  & \ket{\chi_1(\mathbf{x}_1)   \cdots  \chi_i(\mathbf{x}_i)  \cdots  \chi_i(\mathbf{x}_j)  \cdots   \chi_N(\mathbf{x}_N)}
\end{align*}

If $S_N$ is the group of all possible $N!$ permutations we can define the \textit{antisymmetrizer} operator as :
\begin{equation}\label{eq:antisymmetrizer}
	\mathcal{A} = \frac{1}{N!} \sum_{\hat{P} \in S_n} (-1)^{\sigma_P} \hat{P}
\end{equation}

We can now re-express the Slater determinant \eqref{eq:SlaterDet} in a more useful form. Using the Leibniz formula for determinants we rewrite the determinant as:
\begin{equation}\label{eq:SlaterLeibniz}
	\left|
	\begin{matrix}
		   \chi _1 & \chi _2 & \cdots  & \chi _N  \\
	\end{matrix} 
	\right| = \frac{1}{\sqrt{N!}} \sum_{\hat{P} \in S_n} (-1)^{\sigma_P} \hat{P} \ket{\chi_1(\mathbf{x}_1) \cdots   \chi_N(\mathbf{x}_N)}
\end{equation}
Thus:
\begin{equation}
	\left|
	\begin{matrix}
		   \chi _1 & \chi _2 & \cdots  & \chi _N  \\
	\end{matrix} 
	\right| =  (\sqrt{N!}) \mathcal{A} \ket{ \chi_1(\mathbf{x}_1) \cdots   \chi_N(\mathbf{x}_N) }
\end{equation}

This formalism will be useful when dealing with one-electron and two-electrons operators.

\subsubsection{Properties of the Slater determinant}\label{sec:slaterPropr}

It is immediate to verify that by exchanging two electrons in \eqref{eq:SlaterDet} the sign of the determinant changes by a factor of $- 1$, respecting the antisymmetry principle.

Another interesting property is that if two different electrons occupy completely the same spin-orbitals, the matrix will have two identical rows (because the electrons are identical the electron index is to be considered mute) and the determinant will be null. So the Slater determinant respect the Pauli principle, two identical fermions cannot occupy the same spacial orbital having both the same spin (i.e. cannot be described by the same quantum numbers) \footnote{A different formulation of the Pauli principle is that a wave function of identical fermions must be an eigenfunction of a transposition operator with its parity as eigenvalue}.


To see the effects of the anti-simmetrisation requirement we now consider a system made of two particles. We pick a starting Hartree product of the type: 
\begin{align*}
	\chi_{1}(\mathbf{x}_{1}) = \psi_{1}(\mathbf{r}_{1}) \alpha(\omega_{1})\\
	\chi_{2}(\mathbf{x}_{2}) = \psi_{2}(\mathbf{r}_{1}) \beta(\omega_{2})
\end{align*}
where the two particles occupies two different orbitals each with different spin.

If we anti-symmetrize the product (using the associated Slater determinant), the probability $P(\mathbf{r}_{1},\mathbf{r}_{2}) d\mathbf{r_{1}} d\mathbf{r_{2}}$ of finding electron 1 in position $\mathbf{r}_{1}$ and electron 2 in position $\mathbf{r}_{2}$ within a small volume is equal to \cite[p.52]{Attila}:
\begin{equation*}
	P(\mathbf{r}_{1},\mathbf{r}_{2}) = 
		\frac{1}{2} ( 
			\mid \psi_{1}(\mathbf{r}_1) \mid ^2    
			\mid \psi_{2}(\mathbf{r}_2) \mid ^2   
				+
			\mid \psi_{1}(\mathbf{r}_2) \mid ^2    
			\mid \psi_{2}(\mathbf{r}_1) \mid ^2   
			)
\end{equation*}
In this case the probability is the average of the two possible configuration: electron 1 in $\psi_1$ and electron 2 in $\psi_2$; electron 1 in $\psi_2$ and electron 2 in $\psi_1$.
In this case the probabilities are said to be \textit{uncorrelated}.

But what happens if we try to exchange two particles with the same spin but different orbitals?
\begin{align*}
	\chi_{1}(\mathbf{x}_{1}) = \psi_{1}(\mathbf{r}_{1}) \beta(\omega_{1})\\
	\chi_{2}(\mathbf{x}_{2}) = \psi_{2}(\mathbf{r}_{1}) \beta(\omega_{2})
\end{align*}

What we obtain is \cite[p.53]{Attila}:
\begin{align*}
	P(\mathbf{r}_{1},\mathbf{r}_{2}) = 
		\frac{1}{2} [ &
			\mid \psi_{1}(\mathbf{r}_1) \mid ^2    
			\mid \psi_{2}(\mathbf{r}_2) \mid ^2   
				+
			\mid \psi_{1}(\mathbf{r}_2) \mid ^2    
			\mid \psi_{2}(\mathbf{r}_1) \mid ^2   
\\
			& - ( \psi_{1}^*(\mathbf{r}_1) \psi_{2}(\mathbf{r}_1) \psi_{2}^*(\mathbf{r}_2) \psi_{1}(\mathbf{r}_2)
			 + \psi_{1}(\mathbf{r}_1) \psi_{2}^*(\mathbf{r}_1) \psi_{2}(\mathbf{r}_2) \psi_{1}^*(\mathbf{r}_2))]
\end{align*}
where we obtained an extra cross term that makes the probabilities \textit{correlated}. Note that thanks to the extra term we have that $P(\mathbf{r}_{1},\mathbf{r}_{1}) = 0$, respecting the Pauli principle.

This two situations are called respectively a \textit{Fermi Heap} and a \textit{Fermi Hole} \cite{Dan}.


\subsection{The Hartree-Fock method}
We have seen that by the use of the Bohr-Oppenheimer approximation it is possible to consider the motion of nuclei and the motion of electrons as separated. 
We focused on the electronic problem seeing that, by neglecting $\hat{V}_{ee}$ it is possible to separate the Hamiltonian \eqref{eq:H_elec} into $N_e$ independent Hamiltonians \eqref{eq:HartreeHamiltonian}.
What the Hartree-Fock method aims to do is to take under consideration the interaction between electrons while keeping the advantage of a separable Hamiltonian.

\subsubsection{One-electron and Two-electrons Operators}

We rewrite \eqref{eq:H_elec} in his complete form using \eqref{eq:singleElHam} \footnote{Where we have dropped the \textit{e} index}
\begin{equation}
	\hat{H} = \sum_{i}^{N} \hat{h}_{i} + \frac{1}{2} \sum_{i \neq j}^{N} \frac{1}{r_{ij}}
\end{equation}

The operator $\sum_{i}^{N} \hat{h}_{i}$ is called a \textit{one-electron operator} with the following formal definition:

\begin{equation}\label{eq:singleEl}
	\mathcal{O}_{1} := \sum_{i}^{N} \hat{h}_{i}
\end{equation}

Similarly, operator $\frac{1}{2} \sum_{i \neq j}^{N} \frac{1}{r_{ij}}$ is called a \textit{two-electron operator}:

\begin{equation}
	\mathcal{O}_{2} := \frac{1}{2} \sum_{i \neq j}^{N} \frac{1}{r_{ij}}
\end{equation}

We are interested in the effect this two operators have when applied on a single Slater determinant.

Using \eqref{eq:SlaterLeibniz}, the orthonormality of the spin-orbitals composing the Slater determinant \eqref{eq:SlaterDet} and the fact that $r_{ij} = r_{ji}$ one can show that \cite[p.74-81]{Attila}:

\begin{align}
	& \bra{\Psi} \mathcal{O}_{1} \ket{\Psi} = \sum_{i}^{N} \bra{\chi_{i}} \hat{h}_i \ket{\chi_{i}} \\
	& \bra{\Psi} \mathcal{O}_{2} \ket{\Psi} = \frac{1}{2} \sum_{i \neq j}^{N} \bra{\chi_i \chi_i} \frac{1}{r_{ij}} \ket{ \chi_{i} \chi_{i}} - \bra{\chi_i \chi_j} \frac{1}{r_{ij}} \ket{ \chi_{j} \chi_{i}}
\end{align}

Introducing the following notation:
\begin{align}
	\bra{\chi_{i}} \hat{h}_i \ket{\chi_{i}} = \bra{i} \hat{h} \ket{i}
	\\
	\bra{\chi_{i} \chi_{j}} \frac{1}{r_{ij}} \ket{ \chi_{j} \chi_{i}} = \jsqrt{i}{j}
\end{align}

We can write expectation energy for a single Slater determinant as :
\begin{equation}
	\bra{\Psi} \hat{H} \ket{\Psi} = \sum_{i}^{N} \bra{i} \hat{h} \ket{i} + \frac{1}{2} \sum_{i \neq j}^{N} \jsqrt{i}{i} - \ksqrt{i}{j}
\end{equation}

The equation is still not separable and far from being reduced to an eigenvalue problem, but we have an handy expression for the expectation energy of the state of the system

\subsubsection{Variational Method}
So far we made no consideration on the spin-orbitals $\{ \chi_{i} \}$ composing \eqref{eq:SlaterDet}, besides the condition that they are orthonormal.

But what if we want to pick the $\{ \chi_{i} \}$ that correspond to the ground state of our system?

The variational principle comes in help stating that the exact ground state solution to the Schroedinger equation $\hat{H} \ket{\Psi} = E \ket{\Psi}$ is the one that minimizes the functional 
\begin{equation} \label{eq:hamFunctional}
	E_{0}[\{\chi_{i}\}] = \bra{\chi_1 \cdots \chi_N} \hat{H} \ket{\chi_1 \cdots \chi_N} = \bra{\Psi} \hat{H} \ket{\Psi}
\end{equation}

To find the minimum of the functional\eqref{eq:hamFunctional} we must consider his variation for a small variation $\var{\Psi}$ of the test solution $\Psi$  \cite[p.165]{Carati}.  

\begin{align}
	\ket{\Psi} & \rightarrow \ket{\Psi + \var{\Psi}} 
\\
	\bra{\Psi + \var{\Psi}} \hat{H} \ket{\Psi + \var{\Psi}} & = 
		\bra{\Psi} \hat{H} \ket{\Psi} 
		+ \bra{\var{\Psi}} \hat{H} \ket{\Psi} 
		+ \bra{\Psi} \hat{H} \ket{\var{\Psi}} 
		+ \cdots
\\
		 & = E_{0}[\{\chi_{i}\}] + \var{E} + \cdots
\end{align}
Where
\begin{equation}
	\var{E} = \bra{\var{\Psi}} \hat{H} \ket{\Psi} 	+ \bra{\Psi} \hat{H} \ket{\var{\Psi}} 
\end{equation}
is the first order differential of the functional \eqref{eq:hamFunctional} \footnote{$\var{E}$ is not a real function differential, but a functional differential}.

We are looking for the set $\{\chi_i\}$ for which $\var{E} = 0$ \footnote{note that $\Psi$ is a Slater determinant $\mid \chi_1 \cdots \chi_i \cdots \chi_N \mid$}, but we want them to be orthonormal.

To satisfy these two requirements we minimize the following functional \footnote{$\delta_{ij}$ is the Kronecker delta} 
\begin{align}
	\mathcal{L}[\{\chi_{i}\}] & = E[\{\chi_i\}] - \sum_{ij}^{N} \epsilon_{ij} (\bra{\chi_{i}}\ket{\chi_{j}} - \delta_{ij})
\\
	\var{\mathcal{L}} & = \var{E} - \sum_{ij}^{N} \epsilon_{ij} \var{(\bra{\chi_{i}}\ket{\chi_{j}})}	
\end{align}

If $\{\chi_i\}$ are orthonormal $\mathcal{L}[\{\chi_{i}\}]$ and $E[\{\chi_i\}]$ will have the minimum in the same \textit{``point"}. The elements $\epsilon_{ij}$ are called the \textit{Lagrange multipliers}, and they form an Hermitian matrix $\{ \epsilon \}_{ij}$.

\begin{align}
	\var{E} 	& = \sum_{i}^{N} \bra{\var{i}} \hat{h}  \ket{i} + \bra{i} \hat{h}  \ket{\var{i}} \\
			& + \frac{1}{2} \sum_{ij}^{N} [ (\var{i})i \mid j j ] + [ i(\var{i}) \mid j j ] + [ i i \mid (\var{j}) j ] + [ i i \mid j (\var{j}) ]\\
			& - \frac{1}{2} \sum_{ij}^{N} [ (\var{i})j \mid j i ] + [ i(\var{j}) \mid j i ] + [ i j \mid (\var{i}) j ] + [ i j \mid j (\var{i}) ]
\end{align}

by splitting the sum and inverting the indexes we have \cite[p.117-119]{Attila}:
\begin{align}
	\var{E} = &  \sum_{i}^{N} \bra{\var{i}} \hat{h}  \ket{i} + \sum_{ij}^{N}  [ (\var{i})i \mid j j ] - [ (\var{i}) j \mid j i ]  \label{eq:trick} \\
	& +  cc
\end{align}
where $cc$ is the complex conjugate of \eqref{eq:trick}.

Also
\begin{align}
	\sum_{ij}^{N} \epsilon_{ij} \var{(\bra{i}\ket{j})} = \sum_{ij}^{N} \epsilon_{ij} \bra{\var{i}}\ket{j} \label{eq:trick2}
\end{align}

Putting together \eqref{eq:trick} and \eqref{eq:trick2}:
\begin{align}
	\var{\mathcal{L}} & = \sum_{i}^{N} \bra{\var{i}} \hat{h}  \ket{i} + \sum_{ij}^{N}  [ (\var{i})i \mid j j ] - [ (\var{i}) j \mid j i ] + \sum_{ij}^{N} \epsilon_{ij} \bra{\var{i}}\ket{j}\\
	& = \sum_{i}^{N} \bra{\var{i}} \left( 
		 \hat{h}  \ket{i} + \sum_{j}^{N}  [ i \mid j j ] - [  j \mid j i ] + \sum_{j}^{N} \epsilon_{ij} \ket{j}
	\right) \label{eq:toNull}
	\\
	& = 0
\end{align}

since \eqref{eq:toNull} must be zero for every $i$ and for every possible variation $\var{i}$, the value between braces must  always be zero.

\begin{equation}
	\hat{h}  \ket{i} + \sum_{j}^{N}  \bra{i} \frac{1}{r_{ij}} \ket{j j } - \bra{ j } \frac{1}{r_{ij}} \ket{j i} + \sum_{j}^{N} \epsilon_{ij} \ket{j} = 0
\end{equation}

We define respectively the \textit{Coulomb operator} and the \textit{Exchange operator} by:
\begin{align}
	J_{j}(1) \chi_{i}(1) = \left[  \int \dd \mathbf{x}_{2} \chi_{j}^{*}(2) \frac{1}{r_{12}} \chi_{j}(2) \right] \chi_i(1) \label{eq:coulombOperator} \\
	K_{j}(1) \chi_{i}(1) = \left[  \int \dd \mathbf{x}_{2} \chi_{j}^{*}(2) \frac{1}{r_{12}} \chi_{i}(2) \right] \chi_j(1)	
\label{eq:exchangeOperator}
\end{align}

where ``$(1)$" is the index of the integration variable of the function.

We finally have that for every $i$:
\begin{align}
	\left[ \hat{h}(1) + \sum_{j}^{N} \hat{J}_{j}(1) - \hat{K}_{j}(1) \right] \ket{\chi_i(1)} = \sum_{j}^{N} \epsilon_{ij} \ket{\chi_{j}(1)} \label{eq:HartreeNonCan}
\end{align}

We define the \textit{Fock operator}\footnote{note that for $i=j$ the term is null}
\begin{equation}\label{eq:FockOperator}
	\hat{f}(1) = \hat{h}(1) + \sum_{j}^{N} \hat{J}_{j}(1) - \hat{K}_{j}(1)
\end{equation}
then :
\begin{align}
	\hat{f}(1)\ket{\chi_i(1)} = \sum_{j}^{N} \epsilon_{ij} \ket{\chi_{j}(1)} 
\end{align}


Because under unitary transformations two Slater determinant can differ only by a phase factor \cite[p.120]{Attila}, the Exchange and Coulomb operator are invariant under any transformation between two orthonormal sets $(\{\chi_j\}$, $\{\chi'_j\})$ .

Since :
\begin{equation}
	\bra{\chi_k}\hat{f}\ket{\chi_i} = \epsilon_{ki}
\end{equation}

The matrix of Lagrange multipliers is the matrix representation of the Fock operator.
Because it is hermitian, it exists a set of orthonormal $\{\chi'_j\}$ that diagonalizes it.
By picking this set $\{\chi'_j\}$ as our base\footnote{We just need to know that they exists because their nature will be exposed by solving \eqref{eq:HartreeFockEquation}} we can rewrite equation \eqref{eq:HartreeNonCan} into:

\begin{align}
	\hat{f} \ket{\chi_i} = \epsilon_{i} \ket{\chi_{i}} \label{eq:HartreeFockEquation}
\end{align}

Equation \eqref{eq:HartreeFockEquation} is called the \textit{Hartree-Fock canonical equation} and reduces our problem of finding the ground state of a given quantum system to a set of $K$ eigenvalue equations, with $K$ being the number of spin-orbitals selected to describe the system. 

$K$ must be at least equal to $N$, the number of electrons in the system, to respect the Pauli principle. The greater is $K$, the finer is our approximation, reaching what is called the ``\textit{Hartree-Fock limit}". But the number of elements to compute in Fock matrix will go as $\frac{K^2}{2}$ seriously impacting on the complexity of the problem, especially from a computational standpoint.

\subsubsection{Closed shell HF and the Roothaan equations}

A set of spin orbitals is said to be \textit{restricted} if :


\[\chi_{i}(\mathbf{x}) = \left\{
  \begin{array}{lr}
    \psi_{j}(\mathbf{r}) \alpha(w)\\
    \psi_{j}(\mathbf{r}) \beta(w)
  \end{array}
\right.
\]

And the closed shell restricted ground state is :
\begin{align}
	\ket{\Psi_{0}} & = \ket{ \psi_{1} \overline{\psi}_{1} \cdots  
	\psi_{j} \overline{\psi}_{j}
	\cdots	
	\psi_{\frac{N}{2}} \overline{\psi}_{\frac{N}{2}}}
	\\
	\psi_{j} & = \psi_{j} \alpha
	\\
	\overline{\psi}_{j} & = \psi_{j} \beta
\end{align}

We can say that every spatial orbital $\psi(\mathbf{r})$ is occupied by both spin-up and spin-down electrons (there is no ``odd" electron alone in a spatial orbital).

Separating the integration of the spin function (which are orthonormal) and taking into account the correlation interaction between electrons with parallel spin (see section \ref{sec:slaterPropr}) \cite[p.132-133]{Attila} the Fock operator became :

\begin{equation}
\hat{f}(1) = \hat{h}(1) +\sum_{j=1}^{N/2}[2\hat J_j(1)-\hat K_j(1)]
\end{equation}

Where $J_j$ and $K_j$ are expressed as functions of the spatial orbitals $\{\psi_i\}$.

Thus the Hartree-Fock equation became:
\begin{equation}\label{eq:hfSpatial}
	\hat{f}(\mathbf{r_1}) \ket{\psi_i(\mathbf{r_1})} = \epsilon_i \ket{\psi(\mathbf{r_1})}
\end{equation}

Instead of using a numerical approach to solve the integro-differential equation \eqref{eq:hfSpatial}, Roothaan showed how to convert the problem to a set of algebraic equations, solvable using matrix techniques.

We therefore introduce a set of K functions $\{ \phi_{\mu}(\mathbf{r}) \mid \mu = 0,\cdots,K\}$ (in general not orthogonal \footnote{It is common for the basis set not to be orthogonal. For example in a simple molecule one can take all the idrogenoid orbitals centered in each atom, then some overlap in the distance between adjacent nuclei is likely to occur.}) called a \textit{Basis set} \footnote{ The choice of the correct basis set has great impact on the solution of the electronic problem. A discussion on the nature and the \textit{art} of basis set selection is far from the goals of this work.} , that can be used to express our spin-orbitals $\{\psi_j\}$.

\begin{equation}
	\ket{\psi_i} = \sum_{\mu}^{K} C_{\mu i} \ket{\phi_{\mu}}
\end{equation}

Substituting inside \eqref{eq:hfSpatial} :
\begin{equation}
	\hat{f}(1) \sum_{\nu}^{K} C_{\nu i} \ket{\phi_{\nu}(1)}  = \epsilon_i \sum_{\nu}^{K} C_{\nu i} \ket{\phi_{\nu}(1)}
\end{equation}

multiplying by $\bra{\phi_{\mu}}$ we get :

\begin{equation}
	 \sum_{\nu}^{K} C_{\nu i} \bra{\phi_{\mu}(1)}\hat{f}(1)\ket{\phi_{\nu}(1)}  
	 = \epsilon_i \sum_{\nu}^{K} C_{\nu i} \bra{\phi_{\mu}(1)}\ket{\phi_{\nu}(1)}
\end{equation}

Taking under consideration every $\psi_i$ we can write the equation in matrix form:
\begin{equation}
\boxed{
\mathbf{FC} = \mathbf{SC\epsilon}
}
\end{equation}

\subsubsection{The Self Consistent Field Method}

We have finally obtained an expression of $V_{ee}$ that keeps the electronic Hamiltonian \eqref{eq:H_elec} separated.

Each electron on the $i$-th spin-orbital is subject to the following external potential:
\begin{align}
	\hat{v}^{HF} = \sum_{j}^{N} \hat{J}_{j} - \hat{K}_{j}
\end{align}

$\hat{v}^{HF}$ is referred as an average potential because it consider the effect of the average distribution of the $N-1$ electrons on the $i$-th electron. It also takes under consideration any exchange correlation thanks to the exchange operator $\hat{K}_j$.

As shown in equations \eqref{eq:coulombOperator} and \eqref{eq:exchangeOperator},
the Fock operator appears to be an implicit operator because it depends on the basis set we pick for the Slater determinant.
\begin{equation}
\hat{f} = \hat{f}[\{\psi_{j}\}]
\end{equation}


This forbids the possibility to solve the problem with a direct approach. Instead it is necessary to follow an iterative method.

We need a set of starting pre-defined orbitals $\{\psi_i\}$. 








\section{Computational Architectures} \label{comparch:sec}


We have tested on NUMA and GALILEO and ...


\subsection{NetXScale Cluster Architecture}\label{galileoarch:sec}
\subsection{NUMA-CC Architecture}\label{numaarch:sec}


\section{Discussion and Conclusion}

May the force be with you.

%In this work, we relate the insect concentration fluctuations to the
%dissipation of Milan University budget to catering companies.
%%
%We find it appropriate to name the present result ``{\em
%fluctuation-dissipation theorem}''.


%------------------------------------------------------------------
%  BIBLIOGRAPHY
%------------------------------------------------------------------
\clearpage
\addcontentsline{toc}{section}{Bibliography}
\begin{thebibliography}{9}

% note that the references must be listed in the same order as they are cited
% in the text above:

%\bibitem{Manini82} % standard format for a book:
%X. Manini and G. D'Annunzio,
%{\it Terra Vergine} (Springer-Verlag, Berlin, 1882).
%
%\bibitem{Jones55} % standard format for a journal article:
%M. Jones and J. Mones, J. Irreprod. Results {\bf 83}, 2322 (1955).
%
%\bibitem{Dragoni11}  % standard format for a thesis:
%D. Dragoni, {\it Interfacial layering of ionic liquids on solid surfaces},
%diploma thesis (University Milan, 2011),
%\url{http://www.mi.infm.it/manini/theses/dragoni.pdf}.

\bibitem{Atkins97}
P. W. Atkins and R. S. Friedman,
Molecular Quantum Mechanics,
Oxford University Press, New York,
3rd Edition,
1997.

\bibitem{Attila}
A. Szabo, N. S. Ostlund,
Modern Quantum Chemistry: Introduction to Advanced Electronic Structure Theory,
Dover Pubblications, New York,
1996.

\bibitem{Dan}
D. Dan, Notes on General Chemistry,
Chapter 3.5, Many-electron atoms: Fermi holes and Fermi heaps,
W. H. Freeman Publisher,
2006.

\bibitem{Sakurai}
J. J. Sakurai,
Modern Quantum Mechanics,
Addison-Wesley,
Revised Edition,
1994.

\bibitem{Carati}
A. Carati, L.Galgani,
Appunti di Meccanica Razionale 1,
\url{http://users.mat.unimi.it/users/carati/#Didattica}.

\end{thebibliography}


\end{document}


