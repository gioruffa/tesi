% draft 3rd year diploma thesis, by Nick Manini, 2013/03/22
\documentclass[a4paper,12pt]{article}
\usepackage[english]{babel} % or other languages, e.g:
%\usepackage[italian]{babel} % needs debian package texlive-lang-italian
%\usepackage[latin1]{inputenc} % use to reproduce accented characters correctly
\usepackage{hyperref}
\usepackage{graphicx}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{physics}
\usepackage[width=125mm]{caption}

\usepackage[document]{ragged2e}

% Dimensione della pagina
\setlength{\oddsidemargin}{.3in}  % Distance from the left edge -1 inch 
\setlength{\textwidth}{145mm}     % Normal width of the text
\setlength{\topmargin}{.25in}     % Distance from top to PAGE'S HEAD -1 inch
\setlength{\textheight}{225mm}    % Height of the body of page
\setlength{\headheight}{0mm}      % Height of a box containing the head
\setlength{\parskip}{0.5mm}         % Extra vertical space before a paragraph
\setlength{\parindent}{9mm}       % Width of the indentation 
\linespread{1.12}                 % Line spacing        
\renewcommand{\floatpagefraction}{.9}

\usepackage{xcolor}
\newcommand\mynotes[1]{\begin{flushright}\textcolor{red}{TODO: #1}\end{flushright}}

\begin{document}

\title{\bf \Huge Titolazzo della tesi, if seems long\\go to newline }


\author{Giorgio Ruffa\\
Dipartimento di Fisica, Universit\`a degli Studi di Milano,\\
Via Celoria 16, 20133 Milano, Italia
}
\date{April 22, 2016} % the exact date of graduation, when available


\include {frontespizio} % eccezionalmente qui include il frontespizio
% in general avoid \include altoghether, it is looking for trouble !!

\newpage\qquad
\newpage

\maketitle

%---------------------------------------------------------
\begin{abstract}

A long time ago in a galaxy far, far away...

\vskip0.75cm
\hskip5cm
\parbox[t]{7cm}
{
Advisor: {\it Prof. Dario Tamascelli}\\
Co-Advisor: {\it Prof. Michele Ceotto}
}
\end{abstract}
%--------------------------------------------------------

\newpage
\tableofcontents
\newpage

%----------------------------------------------------------------------------
\section{Quantum Espresso}
%----------------------------------------------------------------------------

Quantum ESPRESSO is an integrated suite of Open-Source computer codes for electronic-structure calculations and materials modeling at the nanoscale.
It is based on density-functional theory, plane waves, and pseudopotentials.

\mynotes{Scritto per girare su un gazilione di architetture}

\section{Theoretical Introduction}\label{model:sec}
\mynotes{metti citazione da manuale giocoleria su divisione del problema in piccole parti risolvibili}

This section will cover the basic theory upon which Quantum ESPRESSO is based.

By starting with a very general approach we can say that the Hamiltonian associated to a system of atoms with $N_N$ nuclei and $N_e$ electrons can be written as:


\begin{equation}\label{eq_theHamiltonian}
\hat{H}_{tot} = \hat{T}_{N} + \hat{T}_{e} + \hat{V}_{Ne} + \hat{V}_{NN} + \hat{V}_{ee}
\end{equation}

Where:

\begin{equation}
\hat{T}_{N} = \frac{\hbar}{2} \sum_{\alpha}^{N_N} \frac{\nabla_{\alpha}^2}{M_{\alpha}}
\end{equation}
Is the kinetic energy of the nuclei

\begin{equation}
\hat{T}_{e} = \frac{\hbar}{2m_{e}} \sum_{i}^{N_e} \nabla_{i}^2
\end{equation}
Is the kinetic energy of the electrons

\begin{equation}
\hat{V}_{Ne} = -\frac{e^2}{4\pi\epsilon_{0}} \sum_{i}^{N_e}\sum_{\alpha}^{N_N} \frac{Z_{\alpha}}{\mid R_{\alpha} - r_{i} \mid }
\end{equation}
is the electron-ion attraction potential energy

\begin{equation}
\hat{V}_{NN} = \frac{e^2}{4\pi\epsilon_{0}} \frac{1}{2} \sum_{\alpha \neq \beta}^{N_N} \frac{Z_{\alpha} Z_{\beta}}{\mid R_{\alpha} - R_{\beta} \mid }
\end{equation}
is the nucleus-nucleus repulsion potential energy

\begin{equation}
\hat{V}_{ee} = \frac{e^2}{4\pi\epsilon_{0}} \frac{1}{2} \sum_{i \neq j}^{N_e} \frac{1}{\mid r_{i} - r_{j} \mid }
\end{equation}
is the electron-electron repulsion potential energy

A state function $\ket{\psi}$ describing all the particles involved in the system will evolve following the Schrodinger equation.
\begin{equation}\label{eq:eq_sch}
	i\hbar\dv{t}\ket{\psi(t)} = \hat{H}_{tot}\ket{\psi(t)}
\end{equation}

Although the universality of this equation, we know very well that even a simple molecule like $H_2^{+}$ has no analytical solution.

Thus, even from a computational standpoint, a set of approximations must be performed.


\subsection{The Bohr-Oppenheimer Approximation}

The Bohr-Oppenheimer approximation takes note of the great difference in masses of electrons and nuclei.
Nuclear mass is much higher than electron mass, so we expect that the electrons will have much higher velocities than the nuclei. 

It's now reasonable to separate the motion of the system in two distinct movements: the "slow" movement of the nuclei, and the "fast" movement of the electrons.

We can say that from the point of view of electrons, the nuclei appear to be fixed. 
From a physical standpoint the electrons are moving in the static field produced by the nuclei while still interacting within each others \cite[p.241]{Atkins97}.


Using this approximation the kinetic energy of the nuclei $\hat{T}_{NN}$ can be neglected and the repulsion between the nuclei $\hat{V}_{NN}$, can be considered to be constant.

We will consider now the electronic Hamiltonian $H_{elec}$ :
\begin{equation}
	\hat{H}_{elec} = \hat{T}_{e} + \hat{V}_{Ne} + \hat{V}_{ee}
\end{equation}

Rewriting $H_{elec}$  using atomic units:
\begin{equation}\label{eq:H_elec}
	H_{elec} = - \sum_{i}^{N_{e}} \frac{1}{2} \nabla_{i}^2  - \sum_{i}^{N_{e}} \sum_{\alpha}^{N_{\alpha}} \frac{Z_{\alpha}}{r_{i\alpha}}  + \frac{1}{2} \sum_{i \neq j}^{N_{e}} \frac{1}{r_{ij}}
\end{equation}

The associate Schroedinger equation is,
\begin{equation}
	H_{elec} \Phi_{elec} = \epsilon_{elec} \Phi_{elec}
\end{equation}

With solution
\begin{equation}
	\Phi_{elec} = \Phi_{elec}(r_{\{i\}};R_{\{\alpha\}})
\end{equation}

Where the dependency from the electronic coordinates $\{r_i\}$ is explicit, but the dependency from nuclear coordinates $\{R_{\alpha}\}$ is parametrical.
This implies that also the electronic energy depends parametrically on $\{R_{\alpha}\}$

\begin{equation}
	\epsilon_{elec} = \epsilon_{elec}(\{R_{\alpha}\})
\end{equation}

To obtain the total energy (with fixed nuclei) we have to add the constant ion-ion Coulomb potential energy

\begin{equation}\label{eq:totEn1}
	\epsilon_{tot} = \epsilon_{elec} + \frac{1}{2} \sum_{\alpha \neq \beta}^{N_N} \frac{Z_{\alpha} Z_{\beta} }{R_{\alpha \beta}}
\end{equation}

Equation from \eqref{eq:H_elec} to \eqref{eq:totEn1} constitutes the so called \textit{``Electronic Problem"}.

Once solved one could then apply the same principle to the nuclear problem.
Since the electrons moves much faster then the nuclei, it is reasonable to approximate \eqref{eq_theHamiltonian} by replacing electronic coordinates by their average value, averaged over $\Phi_{elec}$.
The nuclear Hamiltonian will be :
\begin{equation}
	H_{nucl} = - \sum_{\alpha}^{N_{\alpha}} \frac{1}{2M_{\alpha}} \nabla_{\alpha}^2 + \epsilon_{tot}(\{ R_{\alpha}\})
\end{equation}

We can see that $\epsilon_{tot}(\{ R_{\alpha}\})$ is a potential energy surface for nuclear motion.

Thus the nuclei in the Born-Oppenheimer move on a potential energy surface obtained by solving the electronic problem.

The nuclear Schrodinger equation  
\begin{equation}
	H_{nucl} \Phi_{nucl} = \epsilon \Phi_{nucl} 
\end{equation}

with solution 

\begin{equation}
	\Phi_{nucl}=\Phi_{nucl}(\{R_{\alpha}\})
\end{equation}

will describe vibration, rotation, and translation of the molecule.

The complete approximate solution to \eqref{eq_theHamiltonian} will be  \cite[p.43-45]{Attila}

\begin{equation}
	\Phi(\{r_i\};\{R_{\alpha}\}) = \Phi_{elec}(\{r_i\};\{R_{\alpha}\})~\Phi_{nucl}(\{R_{\alpha}\})
\end{equation}


\subsection{The Hartree Product}
\subsubsection{Spin-Orbit}
We introduce two spin functions  $\alpha(\omega), \beta(\omega)$, corresponding respectively to spin up and spin down.
The only conditions we impose is that these two functions are complete and orthonormal.

\begin{equation}
	\bra{\alpha}\ket{\alpha} = \bra{\beta}\ket{\beta} = 1
\end{equation}

\begin{equation}
	\bra{\alpha}\ket{\beta} = \bra{\beta}\ket{\alpha} = 0
\end{equation}

An electron is described both by three spacial coordinates $\mathbf{r}$ and one spin coordinate $\omega$.
\begin{equation}
	\mathbf{x} = \{\mathbf{r},\omega\}
\end{equation}

We define $\psi_i(\mathbf{r})$ a spacial orbital as a function of the position vector $\mathbf{r}$ describing the spacial distribution of an electron, so that $\mid\psi_i(\mathbf{r})\mid^2 {dr}^3$ is the probability of finding the electron in a small volume ${dr}^3$ centered at position $\mathbf{r}$.

Given a set of spatial orbitals we will assume them to be orthonormal, thus if the set is complete we can express any spatial state function as a linear combination of spatial orbitals.

In general, for the set to be complete, one should consider it as infinite. As you can imagine, in practice, an infinite orbitals' set is not available and we will consider only a finite set composed of $K$ such orbitals. The finite set will only cover a certain region of the complete space, but we will consider the results to be ``exact" within the subspace covered by the finite set of spatial orbitals.

The combination of a spatial orbital and a spin function is called a spin orbital and completely describes the electron. 
\begin{equation}
	\chi_{i}(\mathbf{x}) = \psi_i(\mathbf{r}) \alpha(\omega)
\end{equation}


For a set of K spatial orbital will have a corresponding set of $2K$ spin orbitals, each pair sharing the same spatial orbital but with different spin function:

\begin{equation}
	\chi_{2i} = \psi_i(\mathbf{r}) \alpha(\omega)
\end{equation}
\begin{equation}
	\chi_{2i-1} = \psi_i(\mathbf{r}) \beta(\omega)
\end{equation}

Being the spatial orbital and spin orbitals orthonormal, so are the spin orbitals.

\subsubsection{Separating the problem}

It is evident that the term $V_{ee}$ in \eqref{eq:H_elec} is the more complicated to handle in order to find an exact solution to the electronic problem.
To simplify the system we start by neglecting $V_{ee}$, considering the electrons as non interacting.
The Hamiltonian \eqref{eq:H_elec} can be rewritten in the following form:
\begin{equation}\label{eq:HartreeHamiltonian}
	H  = \sum_{i}^{N_e} h_i
\end{equation}
\begin{equation}\label{eq:singleEl}
	h_i = \frac{1}{2} \nabla_{i}^2 - \sum_{\alpha}^{N_N} \frac{Z_{\alpha}}{r_{i\alpha}}
\end{equation}
\begin{equation}
	r_{i\alpha} = \mid r_i - R_{\alpha} \mid
\end{equation}

In this form $H_{elec}$ is composed by a sum of $N_e$ independent single electron Hamiltonians of the form \eqref{eq:singleEl}.

Each operator $h_i$ will have a set of spin orbitals eigenfunctions with eigenvalues given by
\begin{equation}
	h_i \chi_{j}(\mathbf{x}_i) = \epsilon_{i} \chi_{j}(\mathbf{x}_i)
\end{equation}

Since \eqref{eq:HartreeHamiltonian} is a sum of independent Hamiltonians his eigenfunctions will be a product of $h_i$ eigenfunctions
\begin{equation}\label{eq:HartreeProduct}
	\Psi^{HP}(\mathbf{x}_1,...,\mathbf{x}_{N_e}) = \chi_i(\mathbf{x}_1)...\chi_k(\mathbf{x}_{N_e})
\end{equation}
with eigenvalue
\begin{equation}
	H\Psi^{HP} = E\Psi^{HP}
\end{equation}
\begin{equation}
	E = \epsilon_i + \epsilon_j + ... + \epsilon_k
\end{equation}

Equation \eqref{eq:HartreeProduct} is called an Hartree Product and has the following property :
\begin{equation}\label{eq:uncorrelated}
	\mid\Psi^{HP}(\mathbf{x}_1,...,\mathbf{x}_{N_e}) \mid^2 dx_1^3 ... dx_{N_e}^3 = \mid\chi_i(\mathbf{x}_1)\mid^2 dx_1^3 ...\mid \chi_k(\mathbf{x}_{N_e})\mid^2 dx_{N_e}^2
\end{equation}

Meaning that the probability of finding simultaneously each electron in a fixed position (within a small volume) is equal to the uncorrelated probability of finding electron 1 in position $x_1$ times the probability of electron 2 in position $x_2$ and so on (``by independent measurements").
For this reason $\Psi^{HP}$ is called an uncorrelated or electron-independent wave function. Namely the position of an electron has no effect on the position of the others. 

This is, of course, a strong assumption but we will see how the Hartree-Foch method will sharpen the approximation.

\subsubsection{Identical Particles and Slater Determinant}

$\Psi^{HP}$ is the simplest representation of a multi-electron state function, but it does not respect the invariance by exchange of identical particles.
Since elementary particles like electrons are identical or indistinguishable, the probability distribution associated to the state function describing the entire system should remain the same if the coordinates of two or more particles are exchanged.

\begin{equation}
	\mid \Psi(\mathbf{x}_1,\dots,\mathbf{x}_i,\dots,\mathbf{x}_j,\dots,\mathbf{x}_{N_e}) \mid^2 = \mid \Psi(\mathbf{x}_1,\dots,\mathbf{x}_j,\dots,\mathbf{x}_i,\dots,\mathbf{x}_{N_e}) \mid^2
\end{equation}

This implies one of the following conditions:
\begin{align}
	\Psi(\mathbf{x}_1,\dots,\mathbf{x}_i,\dots,\mathbf{x}_j,\dots,\mathbf{x}_{N_e}) = +\Psi(\mathbf{x}_1,\dots,\mathbf{x}_j,\dots,\mathbf{x}_i,\dots,\mathbf{x}_{N_e})\\
	\Psi(\mathbf{x}_1,\dots,\mathbf{x}_i,\dots,\mathbf{x}_j,\dots,\mathbf{x}_{N_e}) = -\Psi(\mathbf{x}_1,\dots,\mathbf{x}_j,\dots,\mathbf{x}_i,\dots,\mathbf{x}_{N_e}) 
\end{align}

Namely that the state function is respectively symmetric or antisymmetric.
Particles with integer spin, like protons, are called bosons and are always represented by symmetric wave functions.
Particles with half integer spin, like electrons, are called fermions and are always represented by antisymmetric wave functions.

We can immediately verify that even the simplest Hartree product composed by only two spin orbit does not respect the antisymmetry principle.

\begin{equation*}
	\Psi^{HP}(\mathbf{x}_1,\mathbf{x}_2) = \chi_1(\mathbf{x}_1) \chi_2(\mathbf{x}_2) \neq \chi_1(\mathbf{x}_2) \chi_2(\mathbf{x}_1)
\end{equation*}

The easiest way to make $\Psi^{HP}$ antisymmetric is to introduce what is called an \textit{exchange term}.

\begin{equation}\label{eq:slater2}
	\Psi(\mathbf{x}_1,\mathbf{x}_2) = \frac{1}{\sqrt{2}} (\chi_1(\mathbf{x}_1) \chi_2(\mathbf{x}_2) - \chi_1(\mathbf{x}_2) \chi_2(\mathbf{x}_1))
\end{equation}

We can rewrite \eqref{eq:slater2} as the determinant of the matrix :
\begin{equation}
\Psi(\mathbf{x}_1,\mathbf{x}_2) = \frac{1}{\sqrt{2}}
\begin{vmatrix}
\chi_1(\mathbf{x}_1) & \chi_2(\mathbf{x}_1) \\
\chi_1(\mathbf{x}_2) & \chi_2(\mathbf{x}_2) 
\end{vmatrix}
\end{equation}

The generalization to $N_e$ electrons held to:

\begin{equation}\label{eq:SlaterDet}
\Psi(\mathbf{x}_1, \mathbf{x}_2, \ldots, \mathbf{x}_N) =
\frac{1}{\sqrt{N!}}
\left|
	\begin{matrix} 
   		\chi_1(\mathbf{x}_1) & \chi_2(\mathbf{x}_1) & \cdots & \chi_N(\mathbf{x}_1) \\
        \chi_1(\mathbf{x}_2) & \chi_2(\mathbf{x}_2) & \cdots & \chi_N(\mathbf{x}_2) \\
		\vdots & \vdots & \ddots & \vdots \\
        \chi_1(\mathbf{x}_N) & \chi_2(\mathbf{x}_N) & \cdots & \chi_N(\mathbf{x}_N)
    \end{matrix} 
	\right|\equiv \left| 
	\begin{matrix}
		   \chi _1 & \chi _2 & \cdots  & \chi _N  \\
	\end{matrix}
   \right|,
\end{equation}

Equation \eqref{eq:SlaterDet} is called the \textit{Slater Determinant} and is the simplest asymmetrical representation of a multi-electron state function.

Using a more formal approach outlined in \cite[p.357-362]{Sakurai} we can express the exchange of two coordinates in \eqref{eq:HartreeProduct} as the action of the transposition operator $P_{ij}$
\begin{align*}
	\hat{P_{ij}} & \ket{\chi_1(\mathbf{x}_1)   \cdots  \chi_i(\mathbf{x}_i)  \cdots  \chi_i(\mathbf{x}_j)  \cdots   \chi_N(\mathbf{x}_N)} =  \\
	& \ket{\chi_1(\mathbf{x}_1)   \cdots  \chi_i(\mathbf{x}_j)  \cdots  \chi_i(\mathbf{x}_i) \cdots  \chi_N(\mathbf{x}_N)} 
\end{align*}
\begin{equation*}
	\hat{P}_{ij} = \hat{P}_{ji} ~;~
	\hat{P}_{ij}^2 = \mathbf{1}
\end{equation*}

For the ket state to be antisymmetric it must be an eigenfunction of $\hat{P}_{ij}$ with eigenvalue $-1$.
\begin{align*}
	\hat{P_{ij}} & \ket{\chi_1(\mathbf{x}_1)   \cdots  \chi_i(\mathbf{x}_i)  \cdots  \chi_i(\mathbf{x}_j)  \cdots   \chi_N(\mathbf{x}_N)} =  \\
	-1 & \ket{\chi_1(\mathbf{x}_1)   \cdots  \chi_i(\mathbf{x}_i)  \cdots  \chi_i(\mathbf{x}_j) \cdots  \chi_N(\mathbf{x}_N)} 
\end{align*}

It can be shown that an arbitrary permutation of N objects can be written as a product of transpositions and that the number of transposition in this decomposition is of fixed parity. That is, either a permutation is always decomposed in an even number of transpositions (the permutation is called even and has the parity $+1$), or a permutation is always decomposed in an odd number of transpositions and then it is an odd permutation with parity  $ - 1$.

Denoting the parity of the arbitrary permutation as $\sigma_P$ it follows that antisymmetric function must respect the following condition :
\begin{align*}
	\hat{P} & \ket{\chi_1(\mathbf{x}_1)   \cdots  \chi_i(\mathbf{x}_i)  \cdots  \chi_i(\mathbf{x}_j)  \cdots   \chi_N(\mathbf{x}_N)} = \\
	(-1)^{\sigma_P}  & \ket{\chi_1(\mathbf{x}_1)   \cdots  \chi_i(\mathbf{x}_i)  \cdots  \chi_i(\mathbf{x}_j)  \cdots   \chi_N(\mathbf{x}_N)}
\end{align*}

If $S_N$ is the group of all possible $N!$ permutations we can define the \textit{antisymmetrizer} operator as :
\begin{equation}\label{eq:antisymmetrizer}
	\mathcal{A} = \frac{1}{N!} \sum_{\hat{P} \in S_n} (-1)^{\sigma_P} \hat{P}
\end{equation}

We can now re-express the slater determinant \eqref{eq:SlaterDet} in a more useful form. Using the Leibniz formula for determinants we rewrite the slater determinant as:
\begin{equation}
	\left|
	\begin{matrix}
		   \chi _1 & \chi _2 & \cdots  & \chi _N  \\
	\end{matrix} 
	\right| = \frac{1}{\sqrt{N!}} \sum_{\hat{P} \in S_n} (-1)^{\sigma_P} \hat{P} \ket{\chi_1(\mathbf{x}_1) \cdots   \chi_N(\mathbf{x}_N)}
\end{equation}
Thus:
\begin{equation}
	\left|
	\begin{matrix}
		   \chi _1 & \chi _2 & \cdots  & \chi _N  \\
	\end{matrix} 
	\right| =  (\sqrt{N!}) \mathcal{A} \ket{ \chi_1(\mathbf{x}_1) \cdots   \chi_N(\mathbf{x}_N) }
\end{equation}

This formalism will be useful when dealing with one-electron and two-electrons operators.

\mynotes{The Pauli principle postulates that a wave function of identical fermions must be an eigenfunction of a transposition operator with its parity as eigenvalue}

\mynotes{
The first consequences of the asymmetry of the fermions ket state is that ...
Pauli Fermi Hole e Fermi Heap. Metti citazione a \cite{Dan}
}



\section{Computational Architectures} \label{comparch:sec}


We have tested on NUMA and GALILEO and ...


\subsection{NetXScale Cluster Architecture}\label{galileoarch:sec}
\subsection{NUMA-CC Architecture}\label{numaarch:sec}


\section{Discussion and Conclusion}

May the force be with you.

%In this work, we relate the insect concentration fluctuations to the
%dissipation of Milan University budget to catering companies.
%%
%We find it appropriate to name the present result ``{\em
%fluctuation-dissipation theorem}''.


%------------------------------------------------------------------
%  BIBLIOGRAPHY
%------------------------------------------------------------------
\clearpage
\addcontentsline{toc}{section}{Bibliography}
\begin{thebibliography}{9}

% note that the references must be listed in the same order as they are cited
% in the text above:

%\bibitem{Manini82} % standard format for a book:
%X. Manini and G. D'Annunzio,
%{\it Terra Vergine} (Springer-Verlag, Berlin, 1882).
%
%\bibitem{Jones55} % standard format for a journal article:
%M. Jones and J. Mones, J. Irreprod. Results {\bf 83}, 2322 (1955).
%
%\bibitem{Dragoni11}  % standard format for a thesis:
%D. Dragoni, {\it Interfacial layering of ionic liquids on solid surfaces},
%diploma thesis (University Milan, 2011),
%\url{http://www.mi.infm.it/manini/theses/dragoni.pdf}.

\bibitem{Atkins97}
P. W. Atkins and R. S. Friedman,
Molecular Quantum Mechanics,
Oxford University Press, New York,
3rd Edition,
1997.

\bibitem{Attila}
A. Szabo, N. S. Ostlund
Modern Quantum Chemistry: Introduction to Advanced Electronic Structure Theory,
Dover Pubblications, New York,
1996.

\bibitem{Dan}
D. Dan, Notes on General Chemistry,
Chapter 3.5, Many-electron atoms: Fermi holes and Fermi heaps,
W. H. Freeman Publisher,
2006.

\bibitem{Sakurai}
J. J. Sakurai,
Modern Quantum Mechanics,
Addison-Wesley,
Revised Edition,
1994.

\end{thebibliography}


\end{document}


